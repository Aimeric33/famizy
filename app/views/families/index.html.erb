<div class="flex flex-row justify-between items-start px-4 pt-4 pb-12 bg-primary-500">
  <%= render partial: 'shared/page_name', locals: { title: t('.title') } %>

  <div class="z-40 fixed bottom-4 -ml-4 w-full flex justify-center md:relative md:bottom-0 md:ml-0 md:w-auto md:flex-col md:items-start md:gap-4">
    <%= link_to t('.btn-primary'), new_family_path, class: "inline-block px-4 py-2 w-4/5 md:w-auto text-center text-white md:text-primary-500 bg-primary-500 md:bg-white rounded-md transition-colors duration-300 transform hover:bg-primary-400 md:hover:bg-slate-100 focus:outline-none focus:ring focus:ring-primary-300 focus:ring-opacity-80" %>
  </div>
</div>

<div class="p-4 relative -top-8 rounded-[24px] bg-white grid grid-cols-1 gap-y-4 auto-rows-fr md:grid-cols-3 md:gap-8">
  <% @families.each do |family| %>
    <%= link_to family_path(family) do %>
      <div class="p-4 bg-slate-100 rounded-md flex flex-col">
        <div class="relative">
          <h3 class="pr-8 text-xl text-gray-800 md:text-2xl">
            <%= family.name %>
          </h3>
        </div>

        <div class="mt-4">
          <p class="text-primary-500">
            <%= t('.members', count: family.users.count) %>
          </p>
          <div class="mt-2 flex items-center">
            <% family.users.first(5).each do |user| %>
              <% if user.avatar.attached? %>
                <%= cl_image_tag user.avatar.key, class: "object-cover w-8 h-8 -mr-1 overflow-hidden rounded-full" %>
              <% else %>
                <div class="object-cover w-8 h-8 -mr-3 overflow-hidden rounded-full">
                  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 40 40">
                    <rect width="100%" height="100%" fill="<%= user.color %>"/>
                    <text fill="#fff" font-family="Helvetica,Arial,sans-serif" font-size="24" font-weight="500" x="50%" y="55%" dominant-baseline="middle" text-anchor="middle">
                      <%= user.name[0].upcase %>
                    </text>
                  </svg>
                </div>
              <% end %>
            <% end %>
            <% if family.users.count > 5 %>
              <span class="ml-2 text-gray-500"><%= t('.and_more') %></span>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
  <% end %>

  <% if @families.empty? %>
    <div class="p-4 bg-slate-100 rounded-md">
      <p class="text-gray-500">
        <%= t('.no-families.text') %>
      </p>
      <p class="mt-2 font-bold text-primary-500">
        <%= t('.no-families.instructions') %>
      </p>
    </div>
  <% end %>
</div>
